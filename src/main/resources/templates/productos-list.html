<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Productos</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background:#f5f5f5; }

        /* Contenedor estilo ventana */
        .window {
          width: 900px;
          margin: 20px auto;
          background:#fff;
          border:2px solid #1e66ff;
          border-radius:10px;
          box-shadow:0 6px 18px rgba(30,102,255,0.15);
          overflow:hidden;
        }
        .titlebar {
          background: linear-gradient(#2f8fe5, #1b6fbf);
          color:#fff;
          padding:10px 12px;
          font-weight:bold;
        }
        .content { padding: 12px; }

        table { width:100%; border-collapse:collapse; background:#fff; }
        th, td { border:1px solid #ddd; padding:8px; text-align:left; }
        th { background:#f0f0f0; }
        tr:hover { background:#f9fbff; }

        .actions {
          display:flex;
          gap:10px;
          padding: 10px 12px 14px;
        }
        .btn {
          padding:6px 14px;
          border:1px solid #333;
          background:#e9e9e9;
          cursor:pointer;
          text-decoration:none;
          color:#000;
          border-radius:2px; /* más “windows” */
        }
        .btn:active { transform: translateY(1px); }
        .hint { font-size: 12px; color:#555; padding: 0 12px 10px; }

        /* radio más centrado */
        .pick { width: 40px; text-align:center; }
    </style>
</head>
<body>

<div class="window">
    <div class="titlebar">Productos</div>

    <div class="content">

        <form id="selectForm">
            <table>
                <thead>
                <tr>
                    <th class="pick"></th>
                    <th>Codigo</th>
                    <th>Descripcion</th>
                    <th>Familia</th>
                    <th>Precio</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${#lists.isEmpty(productos)}">
                    <td colspan="5">No hay productos registrados.</td>
                </tr>

                <tr th:each="p : ${productos}">
                    <td class="pick">
                        <input type="radio" name="idProducto" th:value="${p.idProducto}">
                    </td>
                    <td th:text="${p.idProducto}"></td>
                    <td th:text="${p.nombreProducto}"></td>
                    <td th:text="${p.familia.nombreFamilia}"></td>
                    <td th:text="${p.precio}"></td>
                </tr>
                </tbody>
            </table>
        </form>

    </div>

    <div class="hint">Seleccione un producto y luego presione Editar o Borrar.</div>

    <div class="actions">
        <!-- Nuevo boton -->
        <a class="btn" th:href="@{/productos/new}">Nuevo</a>

        <!-- Editar (usando el id seleccionado) -->
        <button class="btn" type="submit" form="selectForm" formaction="/productos/edit" formmethod="get"
                onclick="return validarSeleccion();">
            Editar
        </button>

        <!-- Borrar  -->
        <button class="btn" type="submit" form="selectForm" formaction="/productos/delete" formmethod="post"
                onclick="return validarSeleccionYConfirmar();">
            Borrar
        </button>

        <!-- Salir -->
        <form th:action="@{/logout}" method="post" style="margin-left:auto;">
            <button class="btn" type="submit">Salir</button>
        </form>
    </div>
</div>

<script>
    function haySeleccion() {
        return document.querySelector('input[name="idProducto"]:checked') !== null;
    }

    function validarSeleccion() {
        if (!haySeleccion()) {
            alert("No ha seleccionado ningún producto.");
            return false;
        }
        return true;
    }

    function validarSeleccionYConfirmar() {
        if (!haySeleccion()) {
            alert("No ha seleccionado ningún producto.");
            return false;
        }
        return confirm("¿Eliminar el producto seleccionado?");
    }
</script>

</body>
</html>
